
前面看到BIOS引导中，在最后加载引导设备的第一个扇区到物理内存0x7C00，然后跳转到0x7C00继续执行。这里加载到0x7C00中的内容就是启动中下面要遇到的主引导记录，即MBR。

#### MBR ####

OS -> MBR  ->  DBR  -> Bootloader -> OS-Kernel

在BIOS中有关键硬件检测，设备初始化，即插即用设备枚举以及存储，启动顺序读取引导扇区！ 

BIOS提供的基本输入输出功能只能在实模式下调用，一旦开启了保护模式，则不再能调用！

为什么有MBR？磁盘上有多种文件系统，用BIOS直接加载内核意味着它要了解文件系统，但是文件系统那么多，BIOS显然无法了解所有的种类！那就约定引导设备的第一个扇区用于加载系统内核。不同文件系统可以用不同MBR，做到文件系统和BIOS的解耦合，z这样就有了更好的扩展性！

其实现代的机器大多是多分区形式，那么需要从主引导记录找活动分区，所以活动分区的引导记录和文件系统耦合，主引导记录根据它其中的分区表，来加载活动分区的引导记录，这个引导记录是存在文件系统中的可以被修改，也和文件系统紧密相关，它可以解析文件系统！

MBR中有446字节可以作为引导代码，其后64字节为分区表，四项内容，每个分区表项为16字节，最后两个字节为标识码！

！！！！！这个引导扇区需要自己编写！！！！

有分区表找到活动分区，然后需要加载活动分区的引导扇区！继续执行，活动分区引导扇区中就包含了一条跳转指令，文件系统信息，以及文件系统识别的代码，用于加载bootloader。

加载起来bootloader以后，它会加载系统的启动配置，现实启动菜单，选择了启动的系统后，开始加载内核

这块可以截图用于说明，两个图！ 视频3.2小节可以截图,说明启动过程

！！！！有两个需要搞，一个是DBR编写，再就是如何将DBR写到磁盘指定位置！！！！

### 中断，异常和系统调用 ###

为何需要中断,异常和系统调用?在操作系统中内核是可以信任,可以执行特权指令,但是它也需要给应用程序提供服务,同时还需要对外设的管理和交互。这就需要系统调用供应用程序调用，以提供服务；对于需要与硬件交互时，为了提高系统性能，则需要中断来提供内核和外设的交互；而对于一些指令执行中遇到的问题是需要内核进行处理的，这就需要异常存在。

区别与联系

    中断由外部设备发起，在指令之间触发！
        系统调用，或软中断，由软件调用int *触发，比如INT 80
            异常则是直径执行过程中出现，比如断点，执行INT 3时出现，除0异常我也是指令中
asdf
